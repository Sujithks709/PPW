<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Perforation DXF Generator</title>
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <style>
        body { font-family: Arial, sans-serif; text-align: center; }
        .preview-container { display: flex; justify-content: center; }
        img, svg { border: 1px solid black; margin-top: 10px; max-width: 100%; }
    </style>
</head>
<body>
    <h2>Perforation DXF Generator</h2>
    <form id="upload-form" enctype="multipart/form-data">
        <input type="file" name="image" required>
        <br><br>
        <label>Pattern Type:</label>
        <select name="pattern_type">
            <option value="staggered">Staggered</option>
            <option value="non-staggered">Non-Staggered</option>
        </select>
        <br><br>
        <label>Spacing (mm):</label>
        <input type="number" name="spacing" value="50" min="10" required>
        <br><br>
        <label>
            <input type="checkbox" name="enable_colors"> Enable Colors
        </label>
        <br><br>
        <button type="submit">Generate DXF</button>
    </form>

    <h3>Preview:</h3>
    <div class="preview-container">
        <img id="image-preview" style="display:none;">
        <svg id="svg-preview" style="display:none;"></svg>
    </div>

    <h3>Download:</h3>
    <a id="download-dxf" style="display:none;" download>Download DXF</a>

    <script>
        $("#upload-form").submit(function(event) {
            event.preventDefault();
            var formData = new FormData(this);

            $.ajax({
                url: "/generate_dxf",
                type: "POST",
                data: formData,
                contentType: false,
                processData: false,
                success: function(response) {
                    $("#download-dxf").attr("href", response.dxf).show();
                    $("#svg-preview").attr("src", response.svg).show();
                }
            });
        });
    </script>
</body>
</html>
